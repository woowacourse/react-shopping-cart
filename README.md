# react-shopping-cart

## 기능 요구 사항

1. **`/cart-items`** API를 호출하여 장바구니 상품 데이터를 불러온다.

- [x] 장바구니 상품 데이터로 장바구니 리스트 UI를 표시한다.

2. 불러온 데이터를 기반으로 클라이언트 상태를 구성하고 관리한다.

- [ ] 개별 상품의 선택 여부, 결제 금액, 배송비 등의 상태를 관리한다.

3. 상품 선택에 따른 결제 금액, 배송비 등의 동적인 변경 사항을 처리한다.

- [x] 진입 시, 전체 선택 되어 있는 것이 디폴트이다.
- [x] 전체 선택을 눌러 모든 상품의 선택 여부를 조절할 수 있다.
- [x] 상품 선택/해제 시 결제 금액을 동적으로 변경한다.
- [x] 결제 금액이 10만원 이상일 경우 배송비는 무료이다.

4. 장바구니 상품의 수량을 변경할 수 있다.

- [x] (+, -) 버튼을 누르면 patch 요청을 보내 수량을 조절할 수 있다.

5. 장바구니에 담긴 상품을 제거할 수 있다.

- [x] 삭제 버튼을 누르면 delete 요청을 보내 상품을 제거할 수 있다.

6. 주문 확인 버튼

- [x] 장바구니에 상품이 없거나, 선택된 상품이 없을 때 주문 확인 버튼이 비활성화 된다.
- [x] 주문 확인버튼 클릭 시 주문 확인 페이지로 이동한다.

7. 주문 확인 페이지

- [x] 헤더에 있던 로고가 백버튼으로 바뀐다.
- [x] 백버튼을 클릭하면 이전 화면으로 돌아간다.
- [x] 결제 예정 최종 정보를 확인할 수 있다.

## step2 : 장바구니 2단계

### 기능 요구 사항

1. 상태 설계

- [x] 상품 정보, 수량, 선택 여부, 쿠폰 등 핵심 상태는 하나의 원천 상태 **(Single Source of Truth)** 로 관리해야 한다.
- [x] 결제 금액, 할인 금액, 배송비 등은 이 상태로부터 **파생된 값** 으로 계산하여 처리한다.

2. 쿠폰 기능 구현

- [x] 다음 4가지 **쿠폰** 을 사용할 수 있어야 한다.

  - 쿠폰 목록

    - [x] 5,000원 할인 쿠폰 (FIXED5000)
      - [x] 최소 주문 금액: 100,000원
      - [x] 할인 금액: 5,000원
      - [x] 만료일: 2025-11-30
    - [x] 2+1 쿠폰 (BOGO)
      - [x] 동일 상품 3개 구매 시 1개 무료
      - [x] 여러 상품이 해당되면 단가가 가장 높은 상품에 적용
      - [x] 만료일: 2025-06-30
    - [x] 무료 배송 쿠폰 (FREESHIPPING)
      - [x] 최소 주문 금액: 50,000원
      - [x] 도서 및 산간 지역 포함
      - [x] 만료일: 2025-08-31
    - [x] 30% 시간제 할인 쿠폰 (MIRACLESALE)
      - [x] 할인율: 30%
      - [x] 적용 시간: 오전 4시 ~ 7시
      - [x] 만료일: 2025-07-31

- [x] 각각의 조건과 효과에 맞는 할인 금액을 파생 상태로 계산해야 한다.

- [x] 금액을 계산할 때는 주문 금액(쿠폰 적용 전)과 최종 결제 금액(쿠폰 적용 후)으로 나누어서 구분한다.

- [x] 주문 금액이 10만원이어서 무료 배송 혜택을 받은 상황에서 미라클 모닝 쿠폰으로 할인을 받아 7만원이 되어도 무료 배송 혜택이 그대로 적용 가능하다.

3. 쿠폰 복합 적용

- [x] 한 번에 **최대 2개의 쿠폰** 을 사용할 수 있어야 한다.

- [x] 적용 순서에 따라 할인 금액이 달라질 수 있으므로, 가장 할인 효과가 큰 **조합을 자동** 으로 선택해야 한다.

4. 배송비 정책
   - [x] 쿠폰 적용 후 결제 금액과 무관하게, 주문 금액(쿠폰 적용 전)이 **100,000원 이상이면 무료 배송** 혜택이 적용된다.
   - [x] **“제주도 및 도서 산간 지역” 체크 시 배송비 3,000원** 추가한다.
   - [x] **FREESHIPPING 쿠폰** 은 도서산간 추가 배송비까지 포함하여 무료 처리해야 한다.

### 프로그래밍 요구사항

1. 상태 관리

- [x] React의 상태 관리 훅(useState, useReducer)을 사용하여 상태를 구성하고, 필요 시에 Context API 등을 활용해 해당 상태가 필요한 컴포넌트 트리에 상태를 전달한다.

2. 역할과 책임

- 단일 책임 원칙
  - [x] 컴포넌트/훅을 잘게 나누고, 각 함수가 하나의 책임만 가지고 있는지 점검한다.
  - [x] 컴포넌트는 UI 표현만 담당하며, 상태 관리 로직이나 파생 상태 계산 로직(e.g. 쿠폰 적용 금액 계산)을 포함하지 않아야 한다.
  - [x] 동일한 값에 대한 계산(e.g. 할인 금액, 배송비 등)은 항상 한 곳에서만 수행되도록 하여 같은, 중복된 책임이 발생하지 않도록 한다.
- 책임 중심 인터페이스
  - [x] 컴포넌트/함수의 인터페이스는 구현에 따라 달라지는 것이 아니라, 책임에 맞게 설계한다. 구현 하기 전에 인터페이스를 먼저 구성하여, 책임을 명확히 한다.
  - [x] 커스텀 훅을 만들기 전, UI가 어떤 데이터와 동작을 필요로 하는지 인터페이스를 먼저 설계해본다.
  - [x] 훅의 반환값은 UI에 필요한 최소한의 정보만 포함하고, 내부 구현은 외부에 드러나지 않도록 캡슐화한다.

3. 모달

- [x] 쿠폰 코드를 입력하기 위한 모달창은 이전 미션에서 만든 모달 컴포넌트 라이브러리를 그대로 사용하여도 무방하다.

4. API

- [x] /coupons API를 호출하여 쿠폰 목록을 불러오고 적용한다.

5. 테스트

- [ ] 쿠폰 적용에 따른 다양한 시나리오에 대한 테스트를 작성한다.
- [x] 시간 조건에 따라 적용 여부가 달라지는 미라클 모닝 쿠폰 적용 케이스도 테스트 가능한 방법을 고민한다.
- [x] 시간, 지역, 주문 금액 등 복잡한 쿠폰 적용 조건에 대해 경계값 테스트를 작성한다.
- [ ] 가장 큰 할인 조합이 적용되는지를 확인하는 테스트를 작성한다.
- [x] 단일한 책임을 가진 순수함수를 작성하여, 테스트 하기 쉽게 만든다.
- [x] 쿠폰 계산 로직은 가능한 한 순수 함수로 작성하고, 컴포넌트나 훅 외부로 분리하여 테스트 하기 쉽게 만든다.

6. localStorage

- [x] 장바구니 선택 상태를 로컬스토리지에 저장하여 새로고침 시에도 유지되도록 한다.
